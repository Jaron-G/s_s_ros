# 在ROS中使用UR机器人

## 前言
通过ROS使用UR机器人是比较简单的, 因为UR系列机器人可以说是使用最为广泛的协作机械臂, 各方面的软件支持和学习资料都非常全面.

## 安装
第一步还是先安装对应的现有软件包(packages), 这里需要安装两个软件包:
1. 由[UR机器人官方](https://github.com/UniversalRobots)提供的机器人驱动软件包: [`Universal_Robots_ROS_Driver`](https://github.com/UniversalRobots/Universal_Robots_ROS_Driver), 其中提供机器人底层驱动, 机器人标定等基本底层功能.
2. 由[`ROS industrial`](https://rosindustrial.org/) 开源项目提供的UR机器人控制软件包: [`Universal Robot`](https://github.com/ros-industrial/universal_robot), 其中提供控制各个版本UR机器人的 ROS 通信节点, 机器人 URDF 模型, 以及 Moveit 控制软件等顶层功能.

与RealSense相机相同, 这两个软件包也都有提供编译好发行版本, 可以分别通过下面的方式安装两行简单的命令安装:

```bash
# Install universal robots ros driver
apt install ros-${ROS_DISTRO}-ur-robot-driver

# Install universal robiots
sudo apt-get install ros-$ROS_DISTRO-universal-robots
```
- UR 官方建议通过这种方式安装ROS driver的软件发行版 (binary release)，因为设置起来比较方便，而且会自动更更新。但同时也指出，一些最新的特性可能还未发行，所以从源代码安装 (build from source) 可以最快体验新开发的特性。

依据[这个说明](../ROS_basics/install_ros_packages.md)，因为后面使用机器人的时候会涉及到很多对于源代码和配置文件的修改，所以我们这里选择从源代码安装，只需要将两个仓库clone到`~/catkin_ws/src`目录，然后再编译工作空间即可：
```bash
# 启动并进入docker container
cd ~/catkin_ws/src

# Clone UR ros driver package repository 
git clone https://github.com/UniversalRobots/Universal_Robots_ROS_Driver.git src/Universal_Robots_ROS_Driver

# Clone Universal Robot package repository
git clone -b $ROS_DISTRO-devel https://github.com/ros-industrial/universal_robot.git
```
- 我们docker里安装的是ROS noetic版本，所以环境变量 ROS_DISTRO的值就是noetic, 所以上面两行命令都会安装noetic版本的软件包
- Universal robot 这个仓库在最近几个月才发行了noetic的版本，之前ROS noetic一直都是用的melodic的软件包，两者是兼容的
- 依据[UR官方ROS2 driver仓库](https://github.com/UniversalRobots/Universal_Robots_ROS2_Driver)的说明，对于moveit的支持已经被合并到了默认的driver软件包里，所以以后使用ROS2来控制UR机器人就不再需要安装这两个包了，安装一个driver包即可。
- 上述命令已经添加到了dockerfile里, 启动容器后不需要再执行
## 测试和使用

### 仿真机器人

### 真实机器人

1. 准备工作
